# Set prefix to Ctrl-Space
set -g prefix C-Space
unbind C-b
bind C-Space send-prefix

# default command to keep from logging in twice
set-option -g default-command "$SHELL"

# Use vi keys
set-option -g mode-keys vi
set-option -g status-keys vi

# Configure status bar
set-option -g status-bg green
set-option -g status-fg white

set-option -g pane-active-border-style fg=colour245,bg=colour245
set-option -g pane-border-style fg=colour238,bg=colour238

# Other minor options
set-option -g base-index 1
set-option -g set-titles on

set-option -g display-time 5000
set-option -g display-panes-time 5000
set-option -g message-limit 100
set-option -g history-limit 20000

if-shell '[ "${TERM##*-}" = "256color" ]' \
            'set-option -g default-terminal "screen-256color"'


#------------------------------------------------------------------------------
# MODE(move pane)
#------------------------------------------------------------------------------
bind-key b \
    select-pane -m \; \
      switch-client -T tester \; \
      display-message 'MODE(move pane) - s=swap, j=join horizontal, J=join vertical'

#----
# Final commands
#----
# Swap panes
bind-key -T tester s \
    swap-pane -d \; \
    select-pane -M

# Join panes horizontally
bind-key -T tester j \
    join-pane \; \
    select-pane -M

# Join panes vertically
bind-key -T tester J \
    join-pane -v \; \
    select-pane -M

#----
# Moving around to target
#----
# Moving around - Windows
bind-key -T tester C-Right \
    next-window \; \
      switch-client -T tester \; \
      display-message 'MODE(move pane) - s=swap, j=join horizontal, J=join vertical'

bind-key -T tester C-Left \
    previous-window \; \
      switch-client -T tester \; \
      display-message 'MODE(move pane) - s=swap, j=join horizontal, J=join vertical'

# Moving around - Panes
bind-key -T tester S-Up \
    select-pane -U \; \
      switch-client -T tester \; \
      display-message 'MODE(move pane) - s=swap, j=join horizontal, J=join vertical'

bind-key -T tester S-Down \
    select-pane -D \; \
      switch-client -T tester \; \
      display-message 'MODE(move pane) - s=swap, j=join horizontal, J=join vertical'

bind-key -T tester S-Left \
    select-pane -L \; \
      switch-client -T tester \; \
      display-message 'MODE(move pane) - s=swap, j=join horizontal, J=join vertical'

bind-key -T tester S-Right \
    select-pane -R \; \
      switch-client -T tester \; \
      display-message 'MODE(move pane) - s=swap, j=join horizontal, J=join vertical'


#------------------------------------------------------------------------------
# Key Bindings
#------------------------------------------------------------------------------

# Copy & paste with pbcopy on OS X.  Make as 'Vi' like as possible.
unbind-key -t vi-copy v
bind-key   -t vi-copy v begin-selection

unbind-key -t vi-copy y
if-shell '[ "$(uname -s)" = "Darwin" ]' \
            'bind-key -t vi-copy y copy-pipe "reattach-to-user-namespace pbcopy"' \
            'bind-key -t vi-copy y copy-selection'

unbind-key p
bind-key   p paste-buffer

unbind-key P
bind-key   P save-buffer "/tmp/tmux-paste-buffer" \; \
        display-message "Copy buffer saved to: /tmp/tmux-paste-buffer"

# Slightly better help keys
unbind-key ?
bind-key   ? list-keys

# TODO - Make this work
#unbind-key C-?
#bind-key   C-? list-keys -t vi-copy

# force a reload of the config file
unbind-key r
bind-key   r source-file     ~/.tmux.conf \; \
             display-message "Reloaded ~/.tmux.conf"

# Cycle panel layouts
unbind-key    Space
bind-key   -r Space next-layout

# Virtical split
unbind-key '"'
bind-key   '"' split-window -h

# Find windows containing text
unbind-key /
bind-key   /  command-prompt "find-window '%%'"

# Moving around - Windows
unbind-key -n C-Right
bind-key   -n C-Right next-window

unbind-key -n C-Left
bind-key   -n C-Left previous-window

# Relocating windows
bind-key -n C-S-Left swap-window -t -1
bind-key -n C-S-Right swap-window -t +1

# Moving around - Panes
unbind-key -n S-Up
bind-key   -n S-Up select-pane -U

unbind-key -n S-Down
bind-key   -n S-Down select-pane -D

unbind-key -n S-Left
bind-key   -n S-Left select-pane -L

unbind-key -n S-Right
bind-key   -n S-Right select-pane -R


#------------------------------------------------------------------------------
# Local configurations
#------------------------------------------------------------------------------
source-file "$HOME/.tmux/active/system.tmux"

